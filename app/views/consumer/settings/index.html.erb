<%# Consumer Settings - Profile Management %>
<%# Purpose: Manage user profile, password, and preferences %>

<div class="min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 relative overflow-hidden">
  <%# Animated background elements %>
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute -top-40 -right-40 w-80 h-80 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
    <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
    <div class="absolute top-1/2 left-1/2 w-80 h-80 bg-indigo-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
  </div>

  <%= render 'consumer/shared/header', active: 'settings' %>

  <%# Main Content %>
  <div class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <%# Page Header %>
    <div class="mb-8">
      <h2 class="text-3xl font-bold text-gray-900 mb-2">
        Account Settings ⚙️
      </h2>
      <p class="text-gray-600">Manage your profile and security preferences</p>
    </div>

    <%# Profile Card %>
    <div class="backdrop-blur-xl bg-white/70 rounded-3xl shadow-xl border border-white/20 p-8 mb-8">
      <div class="flex items-center space-x-6 mb-8">
        <div class="w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center text-white text-3xl font-bold shadow-lg ring-4 ring-white">
          <%= @user.email[0].upcase %>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900"><%= @user.email %></h3>
          <div class="flex items-center space-x-2 mt-2">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-indigo-100 text-indigo-700">
              <%= @user.role.titleize %>
            </span>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-700">
              <%= @user.tier.titleize %> Tier
            </span>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
          <input type="text" value="<%= @user.email %>" disabled class="w-full px-4 py-2 rounded-xl border border-gray-300 bg-gray-50 text-gray-500 cursor-not-allowed focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
          <p class="mt-1 text-xs text-gray-500">Email cannot be changed directly. Contact support.</p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Member Since</label>
          <input type="text" value="<%= @user.created_at.strftime('%B %d, %Y') %>" disabled class="w-full px-4 py-2 rounded-xl border border-gray-300 bg-gray-50 text-gray-500 cursor-not-allowed">
        </div>
      </div>
    </div>

    <%# Change Password Card %>
    <div class="backdrop-blur-xl bg-white/70 rounded-3xl shadow-xl border border-white/20 p-8">
      <h3 class="text-xl font-bold text-gray-900 mb-6 flex items-center">
        <svg class="w-5 h-5 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
        Change Password
      </h3>

      <%= form_with model: @user, url: consumer_settings_path, method: :patch, local: true do |f| %>
        <% if @user.errors.any? %>
          <div class="bg-red-50 border border-red-200 rounded-xl p-4 mb-6">
            <h4 class="text-sm font-bold text-red-800 mb-2">Failed to update password:</h4>
            <ul class="list-disc list-inside text-sm text-red-700">
              <% @user.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="space-y-6">
          <div>
            <%= f.label :password, "New Password", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.password_field :password, class: "w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent", placeholder: "Min. 6 characters" %>
          </div>

          <div>
            <%= f.label :password_confirmation, "Confirm New Password", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.password_field :password_confirmation, class: "w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent", placeholder: "Re-enter new password" %>
          </div>

          <div class="flex justify-end pt-4">
            <%= f.submit "Update Password", class: "px-6 py-2 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-200 cursor-pointer" %>
          </div>
        </div>
      <% end %>
    </div>

  </div>
</div>

<%# Add custom animations %>
<%# Animations are now in app/assets/stylesheets/animations.css %>
